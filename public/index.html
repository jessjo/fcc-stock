<!DOCTYPE html>

<html>

		

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20150503/json2.min.js"></script>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
	<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
	<script src="https://jspm.io/system@0.16.js"></script>

		<script>
			
		
		var socket = io.connect();


        
        function getRequest() {
            console.log("message submitted");
            console.log( document.getElementById("m").value);
            socket.emit('chat message',document.getElementById("m").value);
            return false;
            
        }
        
        function removeStock(stock){
            console.log("remove this stock" + stock);
            socket.emit('remove stock', stock);
            return false;
        }
        
        
        
         socket.on('chat message', function(msg){
           var node = document.createElement("li");  
           node.setAttribute("id", msg);
           var textnode = document.createTextNode(msg);         // Create a text node
           node.appendChild(textnode);                              // Append the text to <li>
           document.getElementById("stockList").appendChild(node);     // 
         });
         
         socket.on('remove stock', function(stock){
            console.log("prepare to remove stock");
            var element = document.getElementById(stock);
            element.outerHTML = "";
             
         });
         

$(function () {
    var seriesOptions = [],
        seriesCounter = 0,
        names = ['MSFT', 'AAPL', 'GOOG'];

    /**
     * Create the chart when all data is loaded
     * @returns {undefined}
     */
    function createChart() {

        $('#container').highcharts('StockChart', {

            rangeSelector: {
                selected: 4
            },

            yAxis: {
                labels: {
                    formatter: function () {
                        return (this.value > 0 ? ' + ' : '') + this.value + '%';
                    }
                },
                plotLines: [{
                    value: 0,
                    width: 2,
                    color: 'silver'
                }]
            },

            plotOptions: {
                series: {
                    compare: 'percent'
                }
            },

            tooltip: {
                pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.change}%)<br/>',
                valueDecimals: 2
            },

            series: seriesOptions
        });
    }

    $.each(names, function (i, name) {

        $.getJSON('https://www.highcharts.com/samples/data/jsonp.php?filename=' + name.toLowerCase() + '-c.json&callback=?',    function (data) {

            seriesOptions[i] = {
                name: name,
                data: data
            };

            // As we're loading the data asynchronously, we don't know what order it will arrive. So
            // we keep a counter and create the chart when all the data is loaded.
            seriesCounter += 1;

            if (seriesCounter === names.length) {
                createChart();
            }
        });
    });
});
        
        




	</script>

	<head>
		<title>Free Code Camp Stock Tracker</title>
	</head>

	<header>

	</header>

	<body>
  
    <form>
 
                <form action="">
                  <input id="m" autocomplete="off" /><button onclick="getRequest();">Send</button>
                </form>
		<div id="container" style="height: 400px; min-width: 310px"></div>
		
		<p>{{{stocks}}}</p>
		<div id="stocks"></div>

	</body>

</html>